# This file is a template, and might need editing before it works on your project.
# see https://docs.gitlab.com/ce/ci/yaml/README.html for all available options

# you can delete this line if you're not using Docker
#image: busybox:latest

variables:
  GIT_SUBMODULE_STRATEGY: recursive

# before_script:
#   - echo "Before script section"
#   - echo "For example you might run an update here or install a build dependency"
#   - echo "Or perhaps you might print out some debugging details"
   
# after_script:
#   - echo "After script section"
#   - echo "For example you might do some cleanup here"
   
build:
  stage: build
  only:
    - master
    - testing
  script:
    - echo "Running complete build"
    - python3 sbs
   
linter:
  stage: test
  script: 
    - echo "Running linter"
    - ./scripts/linter.sh

documentation:
  stage: deploy
  script:
    - echo "Generate documentation to https://documentation.skywarder.eu/${CI_PROJECT_NAME}/${CI_COMMIT_REF_NAME}"
    - rm -rf doc/output
    - doxygen doc/Doxyfile
    - rm -rf /srv/code_documentation/${CI_PROJECT_NAME}/${CI_COMMIT_REF_NAME}
    - mkdir -p /srv/code_documentation/${CI_PROJECT_NAME}/
    - mv doc/output/html /srv/code_documentation/${CI_PROJECT_NAME}/${CI_COMMIT_REF_NAME}

# deploy1:
#   stage: deploy
#   script:
#     - echo "Do your deploy here"

# Skyward Build System Configuration File
#
# Copyright (c) 2015-2018 Skyward Experimental Rocketry
# Authors: Alain Carlucci, Alvise de' Faveri Tron
#
# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files (the "Software"), to deal
# in the Software without restriction, including without limitation the rights
# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
# copies of the Software, and to permit persons to whom the Software is
# furnished to do so, subject to the following conditions:
#
# The above copyright notice and this permission notice shall be included in
# all copies or substantial portions of the Software.
#
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
# THE SOFTWARE.
#
# Here's a list of available BoardIds:
#lpc2138_miosix_board
#stm32f103ze_stm3210e-eval
#stm32f103ve_mp3v2
#stm32f100rb_stm32vldiscovery
#stm32f103ve_strive_mini
#stm32f103ze_redbull_v2
#stm32f407vg_stm32f4discovery
#stm32f207ig_stm3220g-eval
#stm32f207zg_ethboard_v2
#stm32f207ze_als_camboard
#stm32l151_als_mainboard
#stm32f407vg_bitsboard
#stm32f205rg_sony-newman
#stm32f429zi_stm32f4discovery
#stm32f103cb_als_mainboard_rev2
#stm32f100cb_tempsensor
#stm32f429zi_oledboard2
#efm32gg332f1024_wandstem
#stm32f411re_nucleo
#stm32f429zi_skyward_anakin
#stm32f100rc_solertegiard
#stm32f205rc_skyward_stormtrooper
#stm32f401vc_stm32f4discovery
#stm32f103c8_breakout
#stm32f100c8_microboard
#stm32f469ni_stm32f469i-disco
#stm32f429zi_skyward_homeone
#stm32f401re_nucleo
#stm32f103c8_skyward_aldeeran


# Syntax of this file:
# SBS_PROJECT: project settings
# srcfiles:    groups of sources to be compiled together
# boards:      main files, located in ENTRY_PATH
# tests:       test files, located in TESTS_PATH

#-----------------------------------#
#            SBS Project            #
#-----------------------------------#
# ENTRY_PATH:       entrypoints folder realative path
# TESTS_PATH:       tests folder realative path
# SRC_PATH:         shared sources folder realative path
# SBS_BASE:         boardcore folder relative path
# PROJECT_INCLUDES: Optional additional include directories, preceeded by -I (eg: -Ilibs/mxgui)
# PROJECT_SUBDIRS:  Optional subfolders which contains additional makefiles (eg: libs/mxgui)
# PROJECT_LIBS:     Optional static libraries. (eg: libs/mxgui/mxgui.a)

[SBS_PROJECT]
Type:             project
ENTRY_PATH:       src/entrypoints
TESTS_PATH:       src/tests
SRC_PATH:         src/shared
SBS_BASE:         .
PROJECT_INCLUDES:  
PROJECT_SUBDIRS:  
PROJECT_LIBS:     

#-----------------------------------#
#          List of Sources          #
#-----------------------------------#
# [name]    -> can be included using '%name'
#     Type: srcfiles
#     Files: a '/n'-separated list of f

[canbus]
Type:       srcfiles
Files:      src/shared/drivers/canbus/CanManager.cpp
            src/shared/drivers/canbus/CanBus.cpp
            src/shared/drivers/canbus/CanInterrupt.cpp

[piksi]
Type:       srcfiles
Files:      src/shared/drivers/piksi/piksi.cpp

[shared]
Type:       srcfiles
Files:      src/shared/scheduler/TaskScheduler.cpp
            src/shared/drivers/spi/SensorSpi.cpp
            src/shared/diagnostic/CpuMeter.cpp
            src/shared/events/EventBroker.cpp
            src/shared/math/Stats.cpp
            src/shared/math/Matrix.cpp
            src/shared/drivers/interrupt/external_interrupts.cpp
            src/shared/utils/aero/AeroUtils.cpp

[pwm]
Type:       srcfiles
Files:      src/shared/drivers/pwm/pwm.cpp

[i2c]
Type:       srcfiles
Files:      src/shared/drivers/i2c/stm32f2_f4_i2c.cpp

[ethernet]
Type:       srcfiles
Files:      src/shared/drivers/ethernet/UdpManager.cpp
            src/shared/drivers/ethernet/W5200/w5200.cpp
            src/shared/drivers/ethernet/W5200/spi_impl.cpp
            src/shared/drivers/ethernet/PacketBuffer.cpp
            src/shared/drivers/ethernet/WatchdogTimer.cpp

[anakin-data]
Type:       srcfiles
Files:      src/shared/boards/AnakinBoard.cpp
            src/shared/drivers/Leds.cpp

[logger]
Type:       srcfiles
Files:      src/shared/logger/Logger.cpp
			libs/tscpp/buffer.cpp
            libs/tscpp/stream.cpp

[gamma868]
Type:       srcfiles
Files:      src/shared/drivers/gamma868/Gamma868.cpp

#[mavchannel]
#Type:       srcfiles
#Files:      src/shared/drivers/mavlink/MavChannel.cpp

[events]
Type:       srcfiles
Files:      src/shared/events/EventBroker.cpp

[test-utils]
Type:       srcfiles
Files:      src/shared/utils/testutils/TestHelper.cpp

[tests]
Type:       srcfiles
Files:      src/tests/catch/test-eventbroker.cpp
            src/tests/catch/test-circularbuffer.cpp
            src/tests/catch/test-xbee.cpp
            src/tests/catch/test-aero.cpp
            src/tests/catch/test-buttonhandler.cpp


#-------------------------------#
#          Entrypoints          #
#-------------------------------#
# [boardname]  -> compile using 'sbs -b boardname'
#     BoardId: see the list at the top of this file
#     BinName: name of the final binary (without extension!)
#     Include: a space-separated list of files, %something will be substituted
#              with the corresponding 'srcfiles'
#     Main:    name of the main file (e.g. 'foo' -> src/entrypoints/foo.cpp)

[config-dsgamma]
Type:       board
BoardId:    stm32f429zi_stm32f4discovery
BinName:    dsgamma-config
Include:    %gamma868
Defines:
Main:       config-dsgamma

[kernel-testsuite]
Type:       board
BoardId:    stm32f429zi_stm32f4discovery
BinName:    kernel-testsuite
Include:    
Defines:
Main:       kernel-testsuite


#--------------------------#
#          Tests           #
#--------------------------#
# [testname]   -> compile using './sbs -b testname'
#     BoardId: see the list at the top of this file
#     BinName: name of the final binary (without extension!)
#     Include: a space-separated list of files, %something will be substituted
#              with the corresponding 'srcfiles'
#     Main:    name of the main file (e.g. 'foo' -> src/tests/foo.cpp)

## Catch

[tests-catch]
Type:       test
BoardId:    stm32f429zi_skyward_homeone
BinName:    tests-catch
Include:    %tests %shared %test-utils
Defines:
Main:       catch/catch-tests-entry

[test-taskscheduler]
Type:       test
BoardId:    stm32f429zi_stm32f4discovery
BinName:    test-taskscheduler
Include:    %shared
Defines:
Main:       test-taskscheduler

[test-serial]
Type:       test
BoardId:    stm32f429zi_stm32f4discovery
BinName:    test-serial
Include:
Defines:
Main:       test-serial

[test-hsm]
Type:       test
BoardId:    stm32f429zi_stm32f4discovery
BinName:    test-hsm
Include:    %shared
Defines:   -DDEBUG
Main:       test-hsm

[test-interrupt]
Type:       test
BoardId:    stm32f429zi_stm32f4discovery
BinName:    test-interrupt
Include:    
Defines:    -DDEBUG
Main:       test-interrupt

[test-logger]
Type:       test
BoardId:    stm32f429zi_stm32f4discovery
BinName:    test-logger
Include:    %shared %logger
Defines:
Main:       logger/test-logger

[test-kalman-benchmark]
Type:       test
BoardId:    stm32f429zi_stm32f4discovery
BinName:    test-kalman-benchmark
Include:    
Defines:
Main:       kalman/test-kalman-benchmark

[test-pinobserver]
Type:       test
BoardId:    stm32f429zi_stm32f4discovery
BinName:    test-pinobserver
Include:    %shared
Defines:
Main:       test-pinobserver


## Drivers

[test-dsgamma]
Type:       test
BoardId:    stm32f429zi_stm32f4discovery
BinName:    test-dsgamma
Include:    %gamma868
Defines:
Main:       drivers/test-dsgamma

[test-imu-adis]
Type:       test
BoardId:    stm32f429zi_skyward_death_stack
BinName:    test-imu-adis
Include:    %shared
Defines:
Main:       drivers/test-imu-adis

[test-mpu9250]
Type:       test
BoardId:    stm32f429zi_skyward_homeone
BinName:    test-mpu9250
Include:    %shared
Defines:
Main:       drivers/test-mpu9250

[test-timer]
Type:       test
BoardId:    stm32f429zi_stm32f4discovery
BinName:    test-timer
Include:    %shared
Defines:    -DDEBUG
Main:       drivers/test-timer

[test-canbus]
Type:       test
BoardId:    stm32f429zi_stm32f4discovery
BinName:    test-canbus
Include:    %shared %canbus
Defines:    -DDEBUG
Main:       drivers/test-canbus

[test-pwm]
Type:       test
BoardId:    stm32f429zi_stm32f4discovery
BinName:    test-pwm
Include:    %shared %pwm
Defines:    -DDEBUG
Main:       drivers/test-pwm

[test-piksi]
Type:       test
BoardId:    stm32f429zi_skyward_homeone
BinName:    test-piksi
Include:    %shared %piksi
Defines:    -DDEBUG
Main:       drivers/test-piksi

[test-IMU]
Type:       test
BoardId:    stm32f429zi_stm32f4discovery
BinName:    test-IMU
Include:    %shared
Defines:    
Main:       drivers/test-IMU

[test-mavlink-multi]
Type:       test
BoardId:    stm32f429zi_skyward_homeone
BinName:    test-mavlink-multi
Include:    %shared %gamma868
Defines:   -DDEBUG
Main:       drivers/test-mavlink-multi

[test-mavlink]
Type:       test
BoardId:    stm32f429zi_skyward_homeone
BinName:    test-mavlink
Include:    %shared %gamma868
Defines:   -DDEBUG
Main:       drivers/test-mavlink

[xbee-bitrate]
Type:       test
BoardId:    stm32f429zi_skyward_death_stack
BinName:    xbee-bitrate
Include:    %shared %gamma868
Defines:   -DDEBUG
Main:       misc/xbee-bitrate

[test-ad7994]
Type:       test
BoardId:    stm32f429zi_skyward_death_stack
BinName:    test-ad7994
Include:    %shared
Defines:
Main:       drivers/test-ad7994

[test-matrix]
Type:       test
BoardId:    stm32f429zi_stm32f4discovery
BinName:    test-matrix
Include:    %shared
Defines:    -DSTANDALONE_CATCH1_TEST
Main:       catch/test-matrix

[test-kalman]
Type:       test
BoardId:    stm32f429zi_stm32f4discovery
BinName:    test-kalman
Include:    %shared
Defines:    -DSTANDALONE_CATCH1_TEST
Main:       catch/test-kalman

#[test-eventbroker]
#Type:       test
#BoardId:    stm32f429zi_stm32f4discovery
#BinName:    test-eventbroker
#Include:    %shared %events
#Defines:    -DSTANDALONE_CATCH1_TEST
#Main:       catch/test-eventbroker

[test-circularbuffer]
Type:       test
BoardId:    stm32f429zi_stm32f4discovery
BinName:    test-circularbuffer
Include:    %shared
Defines:    -DSTANDALONE_CATCH1_TEST
Main:       catch/test-circularbuffer

[test-tempSensor]
Type:       test
BoardId:    stm32f429zi_skyward_homeone
BinName:    test-tempSensor
Include:    %shared
Defines:    -DDEBUG
Main:       drivers/test-tempSensor



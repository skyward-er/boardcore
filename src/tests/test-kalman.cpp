/* Copyright (c) 2018 Skyward Experimental Rocketry
 * Authors: Luca Mozzarelli
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */

#include <Common.h>
#include <kalman/Kalman.h>
#include <kalman/Matrix.hpp>
#include <drivers/HardwareTimer.h>

using namespace miosix;

typedef miosix::Gpio<GPIOG_BASE, 13> greenLed;
typedef miosix::Gpio<GPIOG_BASE, 14> redLed;

int main() {
    {
        FastInterruptDisableLock dLock;
        greenLed::mode(Mode::OUTPUT);
        redLed::mode(Mode::OUTPUT);
    }
    HardwareTimer<uint32_t, 2>& timer = HardwareTimer<uint32_t, 2>::instance();

    std::vector<float> timeArray = {0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1, 1.05, 1.1, 1.15, 1.2, 1.25, 1.3, 1.35, 1.4, 1.45, 1.5, 1.55, 1.6, 1.65, 1.7, 1.75, 1.8, 1.85, 1.9, 1.95, 2, 2.05, 2.1, 2.15, 2.2, 2.25, 2.3, 2.35, 2.4, 2.45, 2.5, 2.55, 2.6, 2.65, 2.7, 2.75, 2.8, 2.85, 2.9, 2.95, 3, 3.05, 3.1, 3.15, 3.2, 3.25, 3.3, 3.35, 3.4, 3.45, 3.5, 3.55, 3.6, 3.65, 3.7, 3.75, 3.8, 3.85, 3.9, 3.95, 4, 4.05, 4.1, 4.15, 4.2, 4.25, 4.3, 4.35, 4.4, 4.45, 4.5, 4.55, 4.6, 4.65, 4.7, 4.75, 4.8, 4.85, 4.9, 4.95, 5, 5.05, 5.1, 5.15, 5.2, 5.25, 5.3, 5.35, 5.4, 5.45, 5.5, 5.55, 5.6, 5.65, 5.7, 5.75, 5.8, 5.85, 5.9, 5.95, 6, 6.05, 6.1, 6.15, 6.2, 6.25, 6.3, 6.35, 6.4, 6.45, 6.5, 6.55, 6.6, 6.65, 6.7, 6.75, 6.8, 6.85, 6.9, 6.95, 7, 7.05, 7.1, 7.15, 7.2, 7.25, 7.3, 7.35, 7.4, 7.45, 7.5, 7.55, 7.6, 7.65, 7.7, 7.75, 7.8, 7.85, 7.9, 7.95, 8, 8.05, 8.1, 8.15, 8.2, 8.25, 8.3, 8.35, 8.4, 8.45, 8.5, 8.55, 8.6, 8.65, 8.7, 8.75, 8.8, 8.85, 8.9, 8.95, 9, 9.05, 9.1, 9.15, 9.2, 9.25, 9.3, 9.35, 9.4, 9.45, 9.5, 9.55, 9.6, 9.65, 9.7, 9.75, 9.8, 9.85, 9.9, 9.95, 10, 10.05, 10.1, 10.15, 10.2, 10.25, 10.3, 10.35, 10.4, 10.45, 10.5, 10.55, 10.6, 10.65, 10.7, 10.75, 10.8, 10.85, 10.9, 10.95, 11, 11.05, 11.1, 11.15, 11.2, 11.25, 11.3, 11.35, 11.4, 11.45, 11.5, 11.55, 11.6, 11.65, 11.7, 11.75, 11.8, 11.85, 11.9, 11.95, 12, 12.05, 12.1, 12.15, 12.2, 12.25, 12.3, 12.35, 12.4, 12.45, 12.5, 12.55, 12.6, 12.65, 12.7, 12.75, 12.8, 12.85, 12.9, 12.95, 13, 13.05, 13.1, 13.15, 13.2, 13.25, 13.3, 13.35, 13.4, 13.45, 13.5, 13.55, 13.6, 13.65, 13.7, 13.75, 13.8, 13.85, 13.9, 13.95, 14, 14.05, 14.1, 14.15, 14.2, 14.25, 14.3, 14.35, 14.4, 14.45, 14.5, 14.55, 14.6, 14.65, 14.7, 14.75, 14.8, 14.85, 14.9, 14.95, 15, 15.05, 15.1, 15.15, 15.2, 15.25, 15.3, 15.35, 15.4, 15.45, 15.5, 15.55, 15.6, 15.65, 15.7, 15.75, 15.8, 15.85, 15.9, 15.95, 16, 16.05, 16.1, 16.15, 16.2, 16.25, 16.3, 16.35, 16.4, 16.45, 16.5, 16.55, 16.6, 16.65, 16.7, 16.75, 16.8, 16.85, 16.9, 16.95, 17, 17.05, 17.1, 17.15, 17.2, 17.25, 17.3, 17.35, 17.4, 17.45, 17.5, 17.55, 17.6, 17.65, 17.7, 17.75, 17.8, 17.85, 17.9, 17.95, 18, 18.05, 18.1, 18.15, 18.2, 18.25, 18.3, 18.35, 18.4, 18.45, 18.5, 18.55, 18.6, 18.65, 18.7, 18.75, 18.8, 18.85, 18.9, 18.95, 19, 19.05, 19.1, 19.15, 19.2, 19.25, 19.3, 19.35, 19.4, 19.45, 19.5, 19.55, 19.6, 19.65, 19.7, 19.75, 19.8, 19.85, 19.9, 19.95, 20, 20.05, 20.1, 20.15, 20.2, 20.25, 20.3, 20.35, 20.4, 20.45, 20.5, 20.55, 20.6, 20.65, 20.7, 20.75, 20.8, 20.85, 20.9, 20.95, 21, 21.05, 21.1, 21.15, 21.2, 21.25, 21.3, 21.35, 21.4, 21.45, 21.5, 21.55, 21.6, 21.65, 21.7, 21.75, 21.8, 21.85, 21.9, 21.95, 22, 22.05, 22.1, 22.15, 22.2, 22.25, 22.3, 22.35, 22.4, 22.45, 22.5, 22.55, 22.6, 22.65, 22.7, 22.75, 22.8, 22.85, 22.9, 22.95, 23, 23.05, 23.1, 23.15, 23.2, 23.25, 23.3, 23.35, 23.4, 23.45, 23.5, 23.55, 23.6, 23.65, 23.7, 23.75, 23.8, 23.85, 23.9, 23.95, 24, 24.05, 24.1, 24.15, 24.2, 24.25, 24.3, 24.35, 24.4, 24.45, 24.5, 24.55, 24.6, 24.65, 24.7, 24.75, 24.8, 24.85, 24.9, 24.95, 25, 25.05, 25.1, 25.15, 25.2, 25.25, 25.3, 25.35, 25.4, 25.45, 25.5, 25.55, 25.6, 25.65, 25.7, 25.75, 25.8, 25.85, 25.9, 25.95, 26, 26.05, 26.1, 26.15, 26.2, 26.25, 26.3, 26.35, 26.4, 26.45, 26.5, 26.55, 26.6, 26.65, 26.7, 26.75, 26.8, 26.85, 26.9, 26.95, 27, 27.05, 27.1, 27.15, 27.2, 27.25, 27.3, 27.35, 27.4, 27.45, 27.5, 27.55, 27.6, 27.65, 27.7, 27.75, 27.8, 27.85, 27.9, 27.95, 28, 28.05, 28.1, 28.15, 28.2, 28.25, 28.3, 28.35, 28.4, 28.45, 28.5, 28.55, 28.6, 28.65, 28.7, 28.75, 28.8, 28.85, 28.9, 28.95, 29, 29.05, 29.1, 29.15, 29.2, 29.25, 29.3, 29.35, 29.4, 29.45, 29.5, 29.55, 29.6, 29.65, 29.7, 29.75, 29.8, 29.85, 29.9, 29.95, 30, 30.05, 30.1, 30.15, 30.2, 30.25, 30.3, 30.35, 30.4, 30.45, 30.5, 30.55, 30.6, 30.65, 30.7, 30.75, 30.8, 30.85, 30.9, 30.95, 31, 31.05, 31.1, 31.15, 31.2, 31.25, 31.3, 31.35, 31.4, 31.45, 31.5, 31.55, 31.6, 31.65, 31.7, 31.75, 31.8, 31.85, 31.9, 31.95, 32, 32.05, 32.1, 32.15, 32.2, 32.25, 32.3, 32.35, 32.4, 32.45, 32.5, 32.55, 32.6, 32.65, 32.7, 32.75, 32.8, 32.85, 32.9, 32.95, 33, 33.05, 33.1, 33.15, 33.2, 33.25, 33.3, 33.35, 33.4, 33.45, 33.5, 33.55, 33.6, 33.65, 33.7, 33.75, 33.8, 33.85, 33.9, 33.95, 34, 34.05, 34.1, 34.15, 34.2, 34.25, 34.3, 34.35, 34.4, 34.45, 34.5, 34.55, 34.6, 34.65, 34.7, 34.75, 34.8, 34.85, 34.9, 34.95, 35, 35.05, 35.1, 35.15, 35.2, 35.25, 35.3, 35.35, 35.4, 35.45, 35.5, 35.55, 35.6, 35.65, 35.7, 35.75, 35.8, 35.85, 35.9, 35.95, 36, 36.05, 36.1, 36.15, 36.2, 36.25, 36.3, 36.35, 36.4, 36.45, 36.5, 36.55, 36.6, 36.65, 36.7, 36.75, 36.8, 36.85, 36.9, 36.95, 37, 37.05, 37.1, 37.15, 37.2, 37.25, 37.3, 37.35, 37.4, 37.45, 37.5, 37.55, 37.6, 37.65, 37.7, 37.75, 37.8, 37.85, 37.9, 37.95, 38, 38.05, 38.1, 38.15, 38.2, 38.25, 38.3, 38.35, 38.4, 38.45, 38.5, 38.55, 38.6, 38.65, 38.7, 38.75, 38.8, 38.85, 38.9, 38.95, 39, 39.05, 39.1, 39.15, 39.2, 39.25, 39.3, 39.35, 39.4, 39.45, 39.5, 39.55, 39.6, 39.65, 39.7, 39.75, 39.8, 39.85, 39.9, 39.95, 40, 40.05, 40.1, 40.15, 40.2, 40.25, 40.3, 40.35, 40.4, 40.45, 40.5, 40.55, 40.6, 40.65, 40.7, 40.75, 40.8, 40.85, 40.9, 40.95, 41, 41.05, 41.1, 41.15, 41.2, 41.25, 41.3, 41.35, 41.4, 41.45, 41.5, 41.55, 41.6, 41.65, 41.7, 41.75, 41.8, 41.85, 41.9, 41.95, 42, 42.05, 42.1, 42.15, 42.2, 42.25, 42.3, 42.35, 42.4, 42.45, 42.5, 42.55, 42.6, 42.65, 42.7, 42.75, 42.8, 42.85, 42.9, 42.95, 43, 43.05, 43.1, 43.15, 43.2, 43.25, 43.3, 43.35, 43.4, 43.45, 43.5, 43.55, 43.6, 43.65, 43.7, 43.75, 43.8, 43.85, 43.9, 43.95, 44, 44.05, 44.1, 44.15, 44.2, 44.25, 44.3, 44.35, 44.4, 44.45, 44.5, 44.55, 44.6, 44.65, 44.7, 44.75, 44.8, 44.85, 44.9, 44.95, 45, 45.05, 45.1, 45.15, 45.2, 45.25, 45.3, 45.35, 45.4, 45.45, 45.5, 45.55, 45.6, 45.65, 45.7, 45.75, 45.8, 45.85, 45.9, 45.95, 46, 46.05, 46.1, 46.15, 46.2, 46.25, 46.3, 46.35, 46.4, 46.45, 46.5, 46.55, 46.6, 46.65, 46.7, 46.75, 46.8, 46.85, 46.9, 46.95, 47, 47.05, 47.1, 47.15, 47.2, 47.25, 47.3, 47.35, 47.4, 47.45, 47.5, 47.55, 47.6, 47.65, 47.7, 47.75, 47.8, 47.85, 47.9, 47.95, 48, 48.05, 48.1, 48.15, 48.2, 48.25, 48.3, 48.35, 48.4, 48.45, 48.5, 48.55, 48.6, 48.65, 48.7, 48.75, 48.8, 48.85, 48.9, 48.95, 49, 49.05, 49.1, 49.15, 49.2, 49.25, 49.3, 49.35, 49.4, 49.45, 49.5, 49.55, 49.6, 49.65, 49.7, 49.75, 49.8, 49.85, 49.9, 49.95, 50, 50.05, 50.1, 50.15, 50.2, 50.25, 50.3, 50.35, 50.4, 50.45, 50.5, 50.55, 50.6, 50.65, 50.7, 50.75, 50.8, 50.85, 50.9, 50.95, 51, 51.05, 51.1, 51.15, 51.2, 51.25, 51.3, 51.35, 51.4, 51.45, 51.5, 51.55, 51.6, 51.65, 51.7, 51.75, 51.8, 51.85, 51.9, 51.95, 52, 52.05, 52.1, 52.15, 52.2, 52.25, 52.3, 52.35, 52.4, 52.45, 52.5, 52.55, 52.6, 52.65, 52.7, 52.75, 52.8, 52.85, 52.9, 52.95, 53, 53.05, 53.1, 53.15, 53.2, 53.25, 53.3, 53.35, 53.4, 53.45, 53.5, 53.55, 53.6, 53.65, 53.7, 53.75, 53.8, 53.85, 53.9, 53.95, 54, 54.05, 54.1, 54.15, 54.2, 54.25, 54.3, 54.35, 54.4, 54.45, 54.5, 54.55, 54.6, 54.65, 54.7, 54.75, 54.8, 54.85, 54.9, 54.95, 55, 55.05, 55.1, 55.15, 55.2, 55.25, 55.3, 55.35, 55.4, 55.45, 55.5, 55.55, 55.6, 55.65, 55.7, 55.75, 55.8, 55.85, 55.9, 55.95, 56, 56.05, 56.1, 56.15, 56.2, 56.25, 56.3, 56.35, 56.4, 56.45, 56.5, 56.55, 56.6, 56.65, 56.7, 56.75, 56.8, 56.85, 56.9, 56.95, 57, 57.05, 57.1, 57.15, 57.2, 57.25, 57.3, 57.35, 57.4, 57.45, 57.5, 57.55, 57.6, 57.65, 57.7, 57.75, 57.8, 57.85, 57.9, 57.95, 58, 58.05, 58.1, 58.15, 58.2, 58.25, 58.3, 58.35, 58.4, 58.45, 58.5, 58.55, 58.6, 58.65, 58.7, 58.75, 58.8, 58.85, 58.9, 58.95, 59, 59.05, 59.1, 59.15, 59.2, 59.25, 59.3, 59.35, 59.4, 59.45, 59.5, 59.55, 59.6, 59.65, 59.7, 59.75, 59.8, 59.85, 59.9, 59.95, 60, 60.05, 60.1, 60.15, 60.2, 60.25, 60.3, 60.35, 60.4, 60.45, 60.5, 60.55, 60.6, 60.65, 60.7, 60.75, 60.8, 60.85, 60.9, 60.95, 61, 61.05, 61.1, 61.15, 61.2, 61.25, 61.3, 61.35, 61.4, 61.45, 61.5, 61.55, 61.6, 61.65, 61.7, 61.75, 61.8, 61.85, 61.9, 61.95, 62, 62.05, 62.1, 62.15, 62.2, 62.25, 62.3, 62.35, 62.4, 62.45, 62.5, 62.55, 62.6, 62.65, 62.7, 62.75, 62.8, 62.85, 62.9, 62.95, 63, 63.05, 63.1, 63.15, 63.2, 63.25, 63.3, 63.35, 63.4, 63.45, 63.5, 63.55, 63.6, 63.65, 63.7, 63.75, 63.8, 63.85, 63.9, 63.95, 64, 64.05, 64.1, 64.15, 64.2, 64.25, 64.3, 64.35, 64.4, 64.45, 64.5, 64.55, 64.6, 64.65, 64.7, 64.75, 64.8, 64.85, 64.9, 64.95, 65, 65.05, 65.1, 65.15, 65.2, 65.25, 65.3, 65.35, 65.4, 65.45, 65.5, 65.55, 65.6, 65.65, 65.7, 65.75, 65.8, 65.85, 65.9, 65.95, 66, 66.05, 66.1, 66.15, 66.2, 66.25, 66.3, 66.35, 66.4, 66.45, 66.5, 66.55, 66.6, 66.65, 66.7, 66.75, 66.8, 66.85, 66.9, 66.95, 67, 67.05, 67.1, 67.15, 67.2, 67.25, 67.3, 67.35, 67.4, 67.45, 67.5, 67.55, 67.6, 67.65, 67.7, 67.75, 67.8, 67.85, 67.9, 67.95, 68, 68.05, 68.1, 68.15, 68.2, 68.25, 68.3, 68.35, 68.4, 68.45, 68.5, 68.55, 68.6, 68.65, 68.7, 68.75, 68.8, 68.85, 68.9, 68.95, 69, 69.05, 69.1, 69.15, 69.2, 69.25, 69.3, 69.35, 69.4, 69.45, 69.5, 69.55, 69.6, 69.65, 69.7, 69.75, 69.8, 69.85, 69.9, 69.95, 70, 70.05, 70.1, 70.15, 70.2, 70.25, 70.3, 70.35, 70.4, 70.45, 70.5, 70.55, 70.6, 70.65, 70.7, 70.75, 70.8, 70.85, 70.9, 70.95, 71, 71.05, 71.1, 71.15, 71.2, 71.25, 71.3, 71.35, 71.4, 71.45, 71.5, 71.55, 71.6, 71.65, 71.7, 71.75, 71.8, 71.85, 71.9, 71.95, 72, 72.05, 72.1, 72.15, 72.2, 72.25, 72.3, 72.35, 72.4, 72.45, 72.5, 72.55, 72.6, 72.65, 72.7, 72.75, 72.8, 72.85, 72.9, 72.95, 73, 73.05, 73.1, 73.15, 73.2, 73.25, 73.3, 73.35, 73.4, 73.45, 73.5, 73.55, 73.6, 73.65, 73.7, 73.75, 73.8, 73.85, 73.9, 73.95, 74, 74.05, 74.1, 74.15, 74.2, 74.25, 74.3, 74.35, 74.4, 74.45, 74.5, 74.55, 74.6, 74.65, 74.7, 74.75, 74.8, 74.85, 74.9, 74.95, 75, 75.05, 75.1, 75.15, 75.2, 75.25, 75.3, 75.35, 75.4, 75.45, 75.5, 75.55, 75.6, 75.65, 75.7, 75.75, 75.8, 75.85, 75.9, 75.95, 76, 76.05, 76.1, 76.15, 76.2, 76.25, 76.3, 76.35, 76.4, 76.45, 76.5, 76.55, 76.6, 76.65, 76.7, 76.75, 76.8, 76.85, 76.9, 76.95, 77, 77.05, 77.1, 77.15, 77.2, 77.25, 77.3, 77.35, 77.4, 77.45, 77.5, 77.55, 77.6, 77.65, 77.7, 77.75, 77.8, 77.85, 77.9, 77.95, 78, 78.05, 78.1, 78.15, 78.2, 78.25, 78.3, 78.35, 78.4, 78.45, 78.5, 78.55, 78.6, 78.65, 78.7, 78.75, 78.8, 78.85, 78.9, 78.95, 79, 79.05, 79.1, 79.15, 79.2, 79.25, 79.3, 79.35, 79.4, 79.45, 79.5, 79.55, 79.6, 79.65, 79.7, 79.75, 79.8, 79.85, 79.9, 79.95, 80, 80.05, 80.1, 80.15, 80.2, 80.25, 80.3, 80.35, 80.4, 80.45, 80.5, 80.55, 80.6, 80.65, 80.7, 80.75, 80.8, 80.85, 80.9, 80.95, 81, 81.05, 81.1, 81.15, 81.2, 81.25, 81.3, 81.35, 81.4, 81.45, 81.5, 81.55, 81.6, 81.65, 81.7, 81.75, 81.8, 81.85, 81.9, 81.95, 82, 82.05, 82.1, 82.15, 82.2, 82.25, 82.3, 82.35, 82.4, 82.45, 82.5, 82.55, 82.6, 82.65, 82.7, 82.75, 82.8, 82.85, 82.9, 82.95, 83, 83.05, 83.1, 83.15, 83.2, 83.25, 83.3, 83.35, 83.4, 83.45, 83.5, 83.55, 83.6, 83.65, 83.7, 83.75, 83.8, 83.85, 83.9, 83.95, 84, 84.05, 84.1, 84.15, 84.2, 84.25, 84.3, 84.35, 84.4, 84.45, 84.5, 84.55, 84.6, 84.65, 84.7, 84.75, 84.8, 84.85, 84.9, 84.95, 85, 85.05, 85.1, 85.15, 85.2, 85.25, 85.3, 85.35, 85.4, 85.45, 85.5, 85.55, 85.6, 85.65, 85.7, 85.75, 85.8, 85.85, 85.9, 85.95, 86, 86.05, 86.1, 86.15, 86.2, 86.25, 86.3, 86.35, 86.4, 86.45, 86.5, 86.55, 86.6, 86.65, 86.7, 86.75, 86.8, 86.85, 86.9, 86.95, 87, 87.05, 87.1, 87.15, 87.2, 87.25, 87.3, 87.35, 87.4, 87.45, 87.5, 87.55, 87.6, 87.65, 87.7, 87.75, 87.8, 87.85, 87.9, 87.95, 88, 88.05, 88.1, 88.15, 88.2, 88.25, 88.3, 88.35, 88.4, 88.45, 88.5, 88.55, 88.6, 88.65, 88.7, 88.75, 88.8, 88.85, 88.9, 88.95, 89, 89.05, 89.1, 89.15, 89.2, 89.25, 89.3, 89.35, 89.4, 89.45, 89.5, 89.55, 89.6, 89.65, 89.7, 89.75, 89.8, 89.85, 89.9, 89.95, 90, 90.05, 90.1, 90.15, 90.2, 90.25, 90.3, 90.35, 90.4, 90.45, 90.5, 90.55, 90.6, 90.65, 90.7, 90.75, 90.8, 90.85, 90.9, 90.95, 91, 91.05, 91.1, 91.15, 91.2, 91.25, 91.3, 91.35, 91.4, 91.45, 91.5, 91.55, 91.6, 91.65, 91.7, 91.75, 91.8, 91.85, 91.9, 91.95, 92, 92.05, 92.1, 92.15, 92.2, 92.25, 92.3, 92.35, 92.4, 92.45, 92.5, 92.55, 92.6, 92.65, 92.7, 92.75, 92.8, 92.85, 92.9, 92.95, 93, 93.05, 93.1, 93.15, 93.2, 93.25, 93.3, 93.35, 93.4, 93.45, 93.5, 93.55, 93.6, 93.65, 93.7, 93.75, 93.8, 93.85, 93.9, 93.95, 94, 94.05, 94.1, 94.15, 94.2, 94.25, 94.3, 94.35, 94.4, 94.45, 94.5, 94.55, 94.6, 94.65, 94.7, 94.75, 94.8, 94.85, 94.9, 94.95, 95, 95.05, 95.1, 95.15, 95.2, 95.25, 95.3, 95.35, 95.4, 95.45, 95.5, 95.55, 95.6, 95.65, 95.7, 95.75, 95.8, 95.85, 95.9, 95.95, 96, 96.05, 96.1, 96.15, 96.2, 96.25, 96.3};

    std::vector<float>  zArray    = {-5.15584, -2.56082, 2.63118, -5.15584, 2.63118, 5.22815, 2.63118, 5.22815, 10.424, 7.82576, 5.22815, 5.22815, 10.424, 13.0229, 15.6225, 13.0229, 18.2227, 20.8236, 23.4251, 28.6301, 31.2335, 31.2335, 31.2335, 36.4424, 36.4424, 44.2606, 57.3041, 59.9147, 62.526, 62.526, 67.7506, 72.9778, 78.2077, 78.2077, 86.0574, 101.775, 93.913, 104.396, 112.266, 120.141, 133.281, 130.651, 146.436, 162.245, 162.245, 164.882, 170.159, 178.078, 188.647, 196.581, 204.521, 207.168, 228.376, 241.653, 244.311, 249.628, 260.27, 270.923, 284.255, 292.262, 313.645, 316.321, 327.032, 343.12, 345.803, 359.232, 369.987, 388.837, 394.229, 410.421, 418.527, 442.882, 445.592, 464.58, 480.883, 491.767, 494.489, 508.113, 527.217, 543.62, 557.309, 571.017, 601.237, 601.237, 617.759, 637.068, 645.354, 661.947, 684.113, 692.437, 714.669, 725.803, 750.899, 762.072, 778.855, 795.666, 815.313, 834.999, 849.083, 866.01, 888.622, 899.948, 922.636, 948.22, 948.22, 976.723, 993.863, 1016.76, 1036.84, 1056.96, 1085.77, 1094.43, 1105.98, 1137.83, 1155.25, 1181.42, 1190.17, 1213.51, 1233.98, 1254.5, 1283.87, 1307.44, 1328.1, 1354.73, 1372.52, 1384.4, 1411.18, 1438.03, 1461.96, 1476.94, 1506.97, 1534.08, 1552.19, 1576.39, 1600.65, 1615.84, 1646.29, 1667.67, 1692.15, 1716.69, 1741.29, 1778.3, 1796.86, 1815.46, 1840.3, 1871.45, 1899.56, 1924.62, 1949.74, 1974.92, 1997.01, 2019.14, 2054.03, 2076.29, 2104.99, 2133.78, 2159.43, 2172.28, 2201.26, 2233.56, 2252.99, 2282.21, 2304.99, 2321.3, 2357.27, 2383.51, 2403.24, 2426.3, 2462.66, 2475.91, 2502.47, 2532.44, 2552.47, 2585.94, 2602.72, 2633, 2646.48, 2680.28, 2683.67, 2734.6, 2744.82, 2761.87, 2799.5, 2813.21, 2840.71, 2861.38, 2892.47, 2913.25, 2947.99, 2961.91, 2986.34, 3003.82, 3035.37, 3052.94, 3081.12, 3102.31, 3120.01, 3148.38, 3169.72, 3194.68, 3219.69, 3248.37, 3255.55, 3273.52, 3309.58, 3331.28, 3345.77, 3363.91, 3393.02, 3414.91, 3436.84, 3462.5, 3491.9, 3510.33, 3525.09, 3554.69, 3569.53, 3599.26, 3614.17, 3640.3, 3651.52, 3696.55, 3707.84, 3734.23, 3745.57, 3764.49, 3791.04, 3817.67, 3832.91, 3848.19, 3874.97, 3897.99, 3921.07, 3951.93, 3944.2, 3982.88, 4006.17, 4037.3, 4049, 4056.81, 4084.2, 4123.45, 4115.59, 4135.26, 4166.83, 4182.65, 4218.34, 4230.27, 4246.2, 4278.14, 4298.15, 4306.17, 4326.25, 4350.4, 4370.57, 4382.69, 4415.1, 4439.48, 4439.48, 4451.69, 4476.16, 4508.89, 4521.2, 4554.09, 4554.09, 4587.09, 4607.78, 4632.67, 4640.98, 4645.14, 4686.82, 4707.73, 4728.69, 4737.08, 4753.9, 4774.96, 4800.3, 4821.47, 4825.71, 4846.93, 4881, 4893.8, 4915.19, 4945.21, 4958.1, 4966.71, 4983.94, 5005.54, 5027.18, 5040.19, 5048.87, 5070.62, 5096.78, 5096.78, 5127.4, 5149.33, 5166.91, 5184.53, 5206.6, 5206.6, 5237.58, 5264.22, 5268.67, 5290.94, 5317.74, 5317.74, 5344.62, 5349.1, 5376.07, 5398.61, 5407.64, 5443.84, 5452.92, 5480.2, 5475.64, 5502.99, 5502.99, 5544.16, 5544.16, 5580.92, 5590.13, 5594.74, 5617.82, 5645.6, 5654.87, 5678.11, 5692.08, 5710.74, 5738.8, 5743.49, 5766.95, 5771.65, 5809.34, 5814.06, 5828.24, 5832.97, 5851.93, 5851.93, 5885.19, 5918.58, 5904.25, 5947.29, 5947.29, 5990.54, 5971.29, 5995.36, 6019.49, 6029.16, 6053.38, 6082.52, 6077.66, 6106.89, 6106.89, 6131.32, 6141.11, 6155.82, 6175.46, 6190.22, 6214.88, 6219.82, 6249.52, 6264.4, 6259.44, 6284.29, 6309.21, 6314.2, 6319.2, 6349.23, 6359.26, 6364.28, 6394.46, 6419.69, 6434.86, 6439.93, 6450.06, 6470.37, 6485.63, 6500.91, 6521.33, 6536.68, 6557.18, 6577.73, 6572.59, 6577.73, 6598.33, 6618.98, 6629.32, 6624.15, 6655.23, 6665.61, 6691.63, 6691.63, 6717.72, 6728.17, 6743.88, 6759.62, 6770.13, 6796.45, 6812.29, 6807.01, 6844.04, 6854.64, 6849.34, 6859.95, 6881.22, 6902.54, 6913.22, 6923.92, 6956.07, 6939.98, 6966.82, 6993.74, 6993.74, 7009.93, 7009.93, 7058.68, 7053.25, 7075, 7075, 7102.25, 7102.25, 7102.25, 7135.07, 7129.59, 7151.52, 7179.02, 7168.01, 7212.13, 7217.66, 7217.66, 7228.73, 7250.92, 7273.16, 7273.16, 7289.88, 7306.63, 7323.41, 7334.62, 7340.23, 7334.62, 7351.45, 7379.59, 7385.23, 7407.81, 7390.87, 7447.49, 7430.46, 7464.54, 7470.24, 7493.05, 7487.34, 7498.76, 7527.38, 7538.85, 7538.85, 7550.34, 7590.68, 7579.13, 7596.45, 7613.81, 7631.2, 7631.2, 7648.62, 7654.44, 7660.26, 7683.58, 7689.42, 7701.11, 7730.41, 7712.82, 7742.16, 7730.41, 7765.7, 7783.4, 7783.4, 7789.31, 7807.06, 7812.98, 7818.91, 7848.61, 7860.52, 7866.49, 7884.4, 7884.4, 7908.33, 7902.34, 7926.33, 7932.34, 7938.35, 7968.47, 7968.47, 7986.6, 7980.55, 7974.51, 8035.12, 8035.12, 8047.29, 8065.58, 8047.29, 8065.58, 8077.8, 8090.04, 8108.42, 8120.7, 8126.85, 8133, 8145.31, 8151.47, 8169.99, 8169.99, 8182.36, 8200.95, 8207.15, 8219.57, 8232.01, 8238.24, 8244.47, 8238.24, 8263.2, 8294.49, 8281.96, 8300.77, 8313.33, 8332.2, 8338.51, 8338.51, 8363.76, 8376.41, 8376.41, 8370.08, 8401.78, 8414.49, 8389.09, 8427.22, 8427.22, 8446.35, 8446.35, 8478.34, 8497.59, 8484.75, 8504.01, 8523.32, 8510.45, 8516.88, 8536.22, 8549.14, 8568.55, 8568.55, 8581.51, 8588, 8581.51, 8614.02, 8614.02, 8646.65, 8633.58, 8640.11, 8633.58, 8666.29, 8679.41, 8685.97, 8699.12, 8692.55, 8705.71, 8705.71, 8745.31, 8725.48, 8751.93, 8745.31, 8765.18, 8778.46, 8805.07, 8778.46, 8811.74, 8805.07, 8805.07, 8825.08, 8838.46, 8831.77, 8851.85, 8831.77, 8865.26, 8885.42, 8865.26, 8892.15, 8912.38, 8898.89, 8932.65, 8932.65, 8980.16, 8932.65, 8946.2, 8959.76, 8959.76, 9000.6, 9000.6, 8993.78, 9021.09, 8993.78, 9041.63, 9027.93, 9041.63, 9048.49, 9069.1, 9062.23, 9096.66, 9096.66, 9082.87, 9089.76, 9103.57, 9103.57, 9138.18, 9138.18, 9131.24, 9138.18, 9172.93, 9165.97, 9186.88, 9186.88, 9172.93, 9200.84, 9207.84, 9214.83, 9207.84, 9214.83, 9249.92, 9249.92, 9256.95, 9263.99, 9271.04, 9271.04, 9285.15, 9299.28, 9299.28, 9278.09, 9313.44, 9320.53, 9313.44, 9320.53, 9334.72, 9356.06, 9341.83, 9356.06, 9341.83, 9356.06, 9370.32, 9384.6, 9406.07, 9377.46, 9420.42, 9406.07, 9413.24, 9449.18, 9427.6, 9441.98, 9456.39, 9456.39, 9463.6, 9449.18, 9463.6, 9514.27, 9492.52, 9478.05, 9507.01, 9499.76, 9536.08, 9507.01, 9514.27, 9499.76, 9536.08, 9543.37, 9557.96, 9543.37, 9565.26, 9572.57, 9572.57, 9594.54, 9609.22, 9594.54, 9579.88, 9609.22, 9623.92, 9623.92, 9631.29, 9616.57, 9660.8, 9631.29, 9631.29, 9638.65, 9653.41, 9653.41, 9668.2, 9675.6, 9705.28, 9690.43, 9683.01, 9697.85, 9705.28, 9720.16, 9727.61, 9727.61, 9727.61, 9742.53, 9750, 9750, 9742.53, 9757.48, 9757.48, 9764.97, 9764.97, 9757.48, 9787.46, 9794.97, 9787.46, 9794.97, 9779.96, 9810.02, 9810.02, 9810.02, 9840.19, 9825.09, 9840.19, 9847.76, 9825.09, 9893.27, 9870.48, 9870.48, 9855.32, 9870.48, 9862.9, 9878.07, 9878.07, 9900.88, 9878.07, 9931.4, 9916.13, 9893.27, 9923.76, 9916.13, 9931.4, 9908.5, 9916.13, 9939.05, 9946.7, 9931.4, 9977.39, 9962.03, 9954.36, 9946.7, 9977.39, 9992.78, 9992.78, 9992.78, 10015.9, 9977.39, 9977.39, 10008.2, 10015.9, 10031.4, 10008.2, 10015.9, 10015.9, 10023.6, 10023.6, 10046.9, 10031.4, 10062.4, 10054.6, 10046.9, 10039.1, 10039.1, 10046.9, 10062.4, 10062.4, 10078, 10078, 10070.2, 10062.4, 10101.3, 10109.1, 10109.1, 10101.3, 10093.5, 10109.1, 10109.1, 10109.1, 10093.5, 10109.1, 10101.3, 10140.5, 10124.8, 10124.8, 10124.8, 10140.5, 10179.8, 10148.3, 10140.5, 10132.6, 10140.5, 10164, 10164, 10164, 10171.9, 10179.8, 10171.9, 10195.6, 10179.8, 10187.7, 10179.8, 10171.9, 10171.9, 10203.5, 10187.7, 10211.4, 10243.1, 10211.4, 10219.3, 10203.5, 10227.2, 10219.3, 10211.4, 10211.4, 10219.3, 10227.2, 10211.4, 10259, 10259, 10227.2, 10235.2, 10227.2, 10243.1, 10243.1, 10267, 10259, 10227.2, 10243.1, 10259, 10243.1, 10267, 10267, 10267, 10267, 10274.9, 10259, 10274.9, 10259, 10267, 10290.9, 10274.9, 10290.9, 10282.9, 10274.9, 10290.9, 10306.9, 10306.9, 10290.9, 10290.9, 10331, 10306.9, 10314.9, 10282.9, 10314.9, 10323, 10290.9, 10306.9, 10323, 10323, 10314.9, 10298.9, 10298.9, 10314.9, 10339, 10347.1, 10314.9, 10298.9, 10323, 10331, 10323, 10331, 10323, 10331, 10339, 10314.9, 10347.1, 10323, 10323, 10314.9, 10355.1, 10323, 10314.9, 10331, 10331, 10339, 10347.1, 10347.1, 10355.1, 10323, 10347.1, 10314.9, 10347.1, 10363.2, 10347.1, 10339, 10355.1, 10363.2, 10355.1, 10371.2, 10339, 10347.1, 10331, 10355.1, 10331, 10331, 10363.2, 10355.1, 10379.3, 10379.3, 10387.4, 10355.1, 10339, 10371.2, 10371.2, 10347.1, 10379.3, 10371.2, 10371.2, 10363.2, 10371.2, 10347.1, 10363.2, 10371.2, 10339, 10363.2, 10331, 10355.1, 10363.2, 10355.1, 10347.1, 10339, 10347.1, 10379.3, 10355.1, 10363.2, 10379.3, 10331, 10379.3, 10363.2, 10355.1, 10355.1, 10371.2, 10371.2, 10347.1, 10331, 10347.1, 10347.1, 10331, 10363.2, 10339, 10363.2, 10339, 10363.2, 10347.1, 10355.1, 10339, 10339, 10347.1, 10314.9, 10314.9, 10339, 10331, 10290.9, 10331, 10347.1, 10355.1, 10323, 10347.1, 10355.1, 10306.9, 10306.9, 10306.9, 10323, 10323, 10331, 10323, 10331, 10298.9, 10298.9, 10323, 10314.9, 10323, 10306.9, 10314.9, 10306.9, 10298.9, 10282.9, 10314.9, 10282.9, 10282.9, 10298.9, 10298.9, 10306.9, 10306.9, 10306.9, 10282.9, 10290.9, 10290.9, 10267, 10290.9, 10290.9, 10282.9, 10290.9, 10267, 10259, 10282.9, 10267, 10243.1, 10259, 10243.1, 10243.1, 10259, 10259, 10251, 10251, 10259, 10243.1, 10274.9, 10211.4, 10235.2, 10243.1, 10235.2, 10243.1, 10219.3, 10227.2, 10211.4, 10203.5, 10219.3, 10219.3, 10219.3, 10195.6, 10203.5, 10203.5, 10211.4, 10227.2, 10211.4, 10195.6, 10171.9, 10179.8, 10171.9, 10179.8, 10164, 10179.8, 10187.7, 10171.9, 10156.2, 10164, 10140.5, 10148.3, 10171.9, 10132.6, 10164, 10117, 10132.6, 10140.5, 10132.6, 10109.1, 10156.2, 10124.8, 10132.6, 10117, 10117, 10101.3, 10078, 10101.3, 10124.8, 10117, 10093.5, 10085.7, 10093.5, 10078, 10070.2, 10070.2, 10070.2, 10039.1, 10039.1, 10054.6, 10031.4, 10078, 10078, 10031.4, 10054.6, 10023.6, 10039.1, 10039.1, 10000.5, 10000.5, 10008.2, 10008.2, 10000.5, 9985.08, 9985.08, 10000.5, 10008.2, 9985.08, 9977.39, 9969.71, 9954.36, 9977.39, 9969.71, 9954.36, 9939.05, 9962.03, 9946.7, 9946.7, 9939.05, 9923.76, 9900.88, 9916.13, 9931.4, 9923.76, 9939.05, 9916.13, 9893.27, 9893.27, 9908.5, 9885.67, 9893.27, 9855.32, 9885.67, 9855.32, 9855.32, 9862.9, 9870.48, 9840.19, 9840.19, 9840.19, 9832.64, 9825.09, 9810.02, 9825.09, 9802.49, 9832.64, 9832.64, 9802.49, 9794.97, 9810.02, 9779.96, 9779.96, 9757.48, 9764.97, 9764.97, 9742.53, 9757.48, 9735.07, 9735.07, 9712.72, 9712.72, 9727.61, 9720.16, 9720.16, 9683.01, 9697.85, 9712.72, 9668.2, 9697.85, 9668.2, 9675.6, 9675.6, 9653.41, 9675.6, 9668.2, 9638.65, 9638.65, 9616.57, 9653.41, 9609.22, 9616.57, 9587.21, 9594.54, 9587.21, 9587.21, 9572.57, 9565.26, 9579.88, 9565.26, 9543.37, 9543.37, 9528.81, 9521.54, 9514.27, 9521.54, 9514.27, 9528.81, 9485.28, 9499.76, 9499.76, 9478.05, 9492.52, 9470.82, 9470.82, 9463.6, 9449.18, 9470.82, 9449.18, 9441.98, 9420.42, 9441.98, 9406.07, 9413.24, 9398.91, 9398.91, 9391.75, 9406.07, 9363.19, 9384.6, 9370.32, 9341.83, 9327.62, 9348.94, 9313.44, 9313.44, 9313.44, 9320.53, 9299.28, 9306.36, 9306.36, 9278.09, 9263.99, 9271.04, 9263.99, 9249.92, 9235.87, 9242.89, 9228.85, 9214.83, 9221.84, 9207.84, 9221.84, 9200.84, 9193.86, 9165.97, 9159.01, 9186.88, 9165.97, 9138.18, 9159.01, 9138.18, 9145.12, 9131.24, 9103.57, 9103.57, 9110.48, 9089.76, 9089.76, 9069.1, 9082.87, 9062.23, 9075.98, 9062.23, 9048.49, 9021.09, 9007.42, 9007.42, 9007.42, 8993.78, 8980.16, 8966.56, 8973.35, 8966.56, 8952.98, 8952.98, 8946.2, 8932.65, 8919.13, 8905.63, 8925.89, 8905.63, 8898.89, 8865.26, 8885.42, 8871.97, 8871.97, 8858.55, 8858.55, 8811.74, 8818.41, 8811.74, 8805.07, 8805.07, 8785.1, 8778.46, 8771.82, 8751.93, 8751.93, 8751.93, 8732.09, 8712.29, 8732.09, 8718.89, 8705.71, 8705.71, 8705.71, 8672.84, 8679.41, 8653.19, 8666.29, 8640.11, 8646.65, 8627.06, 8620.53, 8620.53, 8594.5, 8594.5, 8581.51, 8581.51, 8549.14, 8542.67, 8549.14, 8536.22, 8516.88, 8510.45, 8516.88, 8523.32, 8478.34, 8471.93, 8478.34, 8446.35, 8459.13, 8452.74, 8446.35, 8427.22, 8408.13, 8401.78, 8389.09, 8382.75, 8389.09, 8382.75, 8351.12, 8344.81, 8325.91, 8319.62, 8325.91, 8300.77, 8307.05, 8307.05, 8281.96, 8256.95, 8256.95, 8232.01, 8244.47, 8232.01, 8219.57, 8219.57, 8207.15, 8182.36, 8169.99, 8169.99, 8169.99, 8139.15, 8157.64, 8151.47, 8108.42, 8108.42, 8114.56, 8090.04, 8077.8, 8083.92, 8077.8, 8071.69, 8029.04, 8029.04, 8016.89, 8035.12, 7998.7, 7998.7, 7980.55, 7974.51, 7944.37, 7938.35, 7920.33, 7938.35, 7914.33, 7908.33, 7890.37, 7896.36, 7872.45, 7854.57, 7836.72, 7848.61, 7836.72, 7818.91, 7818.91, 7801.14, 7807.06, 7783.4, 7765.7, 7765.7, 7748.04, 7736.28, 7712.82, 7712.82, 7701.11, 7683.58, 7701.11, 7677.74, 7660.26, 7631.2, 7642.81, 7631.2, 7596.45, 7602.23, 7602.23, 7590.68, 7561.85, 7573.37, 7544.6, 7533.12, 7521.65, 7515.92, 7510.2, 7504.48, 7470.24, 7464.54, 7464.54, 7447.49, 7436.13, 7402.16, 7419.13, 7402.16, 7368.32, 7368.32, 7351.45, 7362.7, 7345.84, 7334.62, 7329.01, 7306.63, 7295.46, 7278.73, 7273.16, 7273.16, 7267.59, 7212.13, 7228.73, 7212.13, 7201.08, 7195.56, 7195.56, 7173.51, 7146.04, 7146.04, 7140.55, 7129.59, 7107.71, 7085.89, 7085.89, 7058.68, 7058.68, 7064.12, 7047.83, 7020.74, 7015.33, 7004.53, 6977.57, 6977.57, 6956.07, 6950.7, 6956.07, 6923.92, 6913.22, 6897.21, 6891.88, 6865.27, 6854.64, 6854.64, 6838.74, 6833.44, 6812.29, 6812.29, 6796.45, 6780.65, 6780.65, 6759.62, 6728.17, 6733.41, 6722.94, 6696.84, 6686.42, 6681.21, 6676.01, 6650.04, 6639.68, 6639.68, 6603.49, 6603.49, 6593.18, 6593.18, 6572.59, 6562.32, 6531.56, 6536.68, 6516.22, 6490.72, 6475.45, 6470.37, 6475.45, 6470.37, 6439.93, 6434.86, 6419.69, 6389.42, 6384.39, 6374.33, 6354.24, 6359.26, 6349.23, 6309.21, 6314.2, 6289.27, 6279.31, 6274.34, 6259.44, 6249.52, 6234.66, 6219.82, 6209.95, 6190.22, 6195.15, 6155.82, 6155.82, 6136.21, 6116.65, 6111.77, 6106.89, 6087.39, 6053.38, 6063.08, 6043.68, 6033.99, 6033.99, 6009.83, 6005, 5976.1, 5961.69, 5961.69, 5947.29, 5928.14, 5909.03, 5899.48, 5885.19, 5875.67, 5875.67, 5837.71, 5832.97, 5818.79, 5795.19, 5795.19, 5762.25, 5776.35, 5752.86, 5729.44, 5720.08, 5696.74, 5692.08, 5682.76, 5673.46, 5650.23, 5645.6, 5627.07, 5599.35, 5585.52, 5571.71, 5562.52, 5562.52, 5539.58, 5512.12, 5516.69, 5498.43, 5493.87, 5475.64, 5462, 5439.31, 5425.72, 5412.16, 5389.59, 5371.57, 5362.58, 5362.58, 5326.69, 5326.69, 5326.69, 5299.87, 5282.03, 5277.57, 5259.78, 5242.02, 5228.72, 5219.86, 5188.94, 5184.53, 5175.72, 5149.33, 5144.94, 5127.4, 5118.64, 5074.98, 5088.05, 5079.33, 5057.57, 5044.53, 5035.85, 5005.54, 5005.54, 4975.32, 4975.32, 4949.5, 4932.33, 4928.04, 4919.47, 4902.35, 4898.08, 4872.47, 4855.44, 4842.68, 4825.71, 4817.23, 4800.3, 4783.4, 4770.75, 4749.69, 4728.69, 4716.11, 4711.92, 4699.36, 4678.47, 4665.95, 4657.62, 4628.52, 4616.07, 4607.78, 4582.96, 4570.58, 4562.33, 4541.74, 4529.41, 4504.8, 4496.61, 4492.51, 4476.16, 4455.76, 4443.54, 4423.22, 4419.16, 4398.88, 4382.69, 4354.43, 4338.31, 4338.31, 4322.23, 4302.16, 4302.16, 4278.14, 4266.15, 4242.22, 4246.2, 4214.37, 4206.43, 4178.69, 4166.83, 4166.83, 4143.14, 4127.39, 4119.52, 4080.28, 4084.2, 4064.63, 4049, 4033.4, 4021.72, 4002.28, 3986.76, 3971.26, 3975.13, 3955.79, 3924.92, 3917.22, 3890.31, 3874.97, 3867.31, 3836.73, 3829.1, 3817.67, 3794.84, 3794.84, 3779.65, 3760.7, 3745.57, 3726.68, 3700.31, 3696.55, 3681.52, 3666.51, 3659.01, 3632.83, 3614.17, 3602.99, 3584.38, 3573.24, 3562.11, 3547.28, 3521.4, 3506.64, 3499.27, 3480.87, 3469.84, 3447.83, 3447.83, 3407.6, 3393.02, 3378.46, 3360.28, 3349.39, 3338.52, 3320.42, 3305.97, 3291.53, 3277.12, 3269.93, 3241.19, 3223.27, 3205.39, 3183.97, 3166.16, 3173.28, 3148.38, 3130.64, 3116.47, 3088.18, 3088.18, 3077.6, 3056.46, 3035.37, 3024.84, 3003.82, 2986.34, 2975.86, 2961.91, 2947.99, 2923.66, 2909.78, 2895.93, 2878.64, 2854.48, 2844.15, 2833.83, 2799.5, 2789.22, 2789.22, 2761.87, 2748.23, 2731.19, 2727.79, 2710.8, 2690.44, 2673.51, 2659.99, 2633, 2619.53, 2619.53, 2589.3, 2589.3, 2552.47, 2539.11, 2539.11, 2515.78, 2499.15, 2479.23, 2462.66, 2449.42, 2423, 2413.12, 2396.66, 2386.79, 2367.1, 2350.72, 2337.63, 2321.3, 2301.73, 2288.71, 2275.71, 2259.48, 2227.09, 2217.4, 2191.59, 2185.15, 2175.5, 2153.01, 2140.18, 2120.97, 2101.8, 2089.04, 2085.85, 2060.39, 2047.68, 2041.33, 2009.65, 1993.85, 1984.38, 1959.17, 1952.88, 1930.89, 1918.35, 1896.43, 1887.06, 1871.45, 1840.3, 1834.08, 1824.77, 1803.06, 1784.49, 1759.78, 1753.61, 1735.13, 1719.76, 1719.76, 1695.21, 1664.61, 1658.5, 1640.2, 1621.93, 1600.65, 1591.55, 1573.36, 1546.15, 1546.15, 1528.05, 1506.97, 1485.94, 1473.94, 1458.96, 1447, 1426.09, 1420.12, 1393.32, 1372.52, 1357.69, 1345.85, 1328.1, 1310.39, 1286.82, 1277.99, 1254.5, 1242.77, 1225.2, 1213.51, 1198.91, 1181.42, 1169.78, 1158.15, 1134.93, 1114.66, 1100.2, 1085.77, 1062.71, 1048.33, 1025.36, 1022.49, 996.723, 993.863, 959.612, 951.067, 931.157, 922.636, 902.781, 885.793, 874.484, 849.083, 843.447, 815.313, 809.696, 787.257, 764.867, 759.278, 750.899, 717.451, 709.106, 681.339, 681.339, 656.413, 645.354, 623.272, 612.249, 592.986, 581.996, 571.017, 540.884, 524.486, 508.113, 494.489, 478.164, 461.865, 453.725, 429.344, 423.934, 394.229, 375.369, 367.298, 348.488, 332.392, 310.97, 289.592, 284.255, 257.608, 246.969, 231.03, 212.466, 193.936, 186.004, 164.882, 146.436, 133.281, 114.89, 104.396, 80.8236, 59.9147, 49.476, 31.2335, 10.424, -5.15584};
    
    float P_data[9] = { 0.1,    0,      0,
        0,      0.1,    0,
        0,      0,      0.1
    };
    
    float R_data[1] = {10};
    
    float Q_data[9] = { 0.01,   0,      0,
        0,      0.01,   0,
        0,      0,      0.01
    };
    
    float H_data[3] = {1, 0, 0};
    
    float Phi_data[9] = {   1,    0,    0,
        0,    1,    0,
        0,    0,    1
    };
    
    // Instanciate matrices
    Matrix P{3,3, P_data};
    Matrix R{1,1, R_data};
    Matrix Q{3,3, Q_data};
    Matrix H{1,3, H_data};
    
    // Instanciate filter object
    Kalman filter = Kalman(P, R, Q, H);
    
    // Set constant values in the state propagation matrix
    filter.Phi.set(Phi_data);
    
    float last_time = 0.0;  // Variable to save the time of the last sample
    float time;             // Current time as read from csv file
    float T;                // Time elapsed between last sample and current one

    // miosix::Timer timer;
    // timer.start();
    timer.start();
    uint32_t tick1;
    uint32_t tick2;
    for (int i = 0; i < (int)timeArray.size(); i++) {
        if (i == 0) {
            filter.X.data[0] = zArray[0];
            continue;
        }
        time = timeArray[i];
        T = time-last_time;
        
        filter.Phi(0,1) = T;
        filter.Phi(0,2) = 0.5*T*T;
        filter.Phi(1,2) = T;
        
        Matrix y{1,1};
        y(0) = zArray[i];
        
        tick1 = timer.tick();
        filter.update(y);
        tick2 = timer.tick();
        printf("%f \n", timer.toMilliSeconds(tick2-tick1));
        // printf("%f, %f, %f\n", filter.X(0), filter.X(1), filter.X(2));
        last_time = time;
        if (filter.X(1) < 0) {
            greenLed::high();
            redLed::low();
        }
        else {
            greenLed::low();
            redLed::high();
        }
    }
    timer.stop();
    // printf("Total time %d \n", timer.interval());
    return 0;
}
